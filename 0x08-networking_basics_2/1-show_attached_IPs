#!/usr/bin/env bash

# Check if 'ip' command is available
if command -v ip &>/dev/null; then
  # Get the list of network interfaces using 'ip' command
  interfaces=$(ip -o link show | awk '{print $2}' | cut -d ':' -f 1)

  # Loop through each interface and extract the IPv4 address
  for interface in $interfaces; do
    # Get the IPv4 address using 'ip' command and 'grep'
    ipv4=$(ip -o addr show dev "$interface" | grep -Eo 'inet ([0-9]*\.){3}[0-9]*' | awk '{print $2}')

    # Display the IPv4 address if it is not empty and not '127.0.0.1'
    if [[ -n "$ipv4" && "$ipv4" != "127.0.0.1" ]]; then
      echo "$ipv4"
    fi
  done
elif command -v ifconfig &>/dev/null; then
  # Get the list of network interfaces using 'ifconfig' (fallback option)
  interfaces=$(ifconfig -a | grep -Eo '^[a-zA-Z0-9]+')

  # Loop through each interface and extract the IPv4 address
  for interface in $interfaces; do
    # Get the IPv4 address using 'ifconfig' and 'grep'
    ipv4=$(ifconfig "$interface" | grep -Eo 'inet (addr:)?([0-9]*\.){3}[0-9]*' | grep -Eo '([0-9]*\.){3}[0-9]*')

    # Display the IPv4 address if it is not empty and not '127.0.0.1'
    if [[ -n "$ipv4" && "$ipv4" != "127.0.0.1" ]]; then
      echo "$ipv4"
    fi
  done
else
  echo "Error: Neither 'ip' nor 'ifconfig' command found. Unable to retrieve network information."
  exit 1
fi
